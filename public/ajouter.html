<!DOCTYPE html>
<html lang="fr">
<head>
<link link rel="icon" type="image/png" href="/images/logo.png">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex">
<title>JukeBox Caf√©</title>
<style>
  body {
    font-family: system-ui, sans-serif;
    background: #fdf8f3;
    text-align: center;
    padding: 2em;
  }
  h1 { color: #d66b00; }
  input {
    width: 90%;
    max-width: 400px;
    padding: 0.8em;
    margin: 1em 0;
    border: 2px solid #d66b00;
    border-radius: 10px;
    font-size: 1em;
  }
  button {
    background: #d66b00;
    color: #fff;
    border: none;
    padding: 0.8em 2em;
    border-radius: 10px;
    font-size: 1em;
    cursor: pointer;
    margin: 0.5em;
  }
  button:hover { background: #ff7f00; }
  #msg { font-size: 0.9em; color: #555; margin-top: 0.5em; }
</style>
</head>
<body>
  <h1>üéµ JukeBox Caf√©</h1>
  <p>Recherche ta musique sur ces diff√©retes plateformes :</p>

  <input id="search" type="text" placeholder="ex : Daft Punk ‚Äì Get Lucky">
  <br>
  <button onclick="searchYTMusic()">üîç Rechercher sur YouTube Music</button>
  <button onclick="searchDeezer()">Ou sur Deezer</button>
  <br><br>
  <input id="link" type="url" placeholder="Colle le lien ici">
  <br>
  <button onclick="addMusic()">üé∂ Ajouter au jukebox</button>
  <p id="msg"></p>

<script>
const params = new URLSearchParams(window.location.search);
const cafe = params.get('caf√©') || 'default';
const msg = document.getElementById('msg');

//https://www.deezer.com/search/
function searchDeezer() {
  const query = encodeURIComponent(document.getElementById('search').value.trim());
  if (!query) { window.open(`https://www.deezer.com/fr/channels/explore/`, '_blank', 'width=1000,height=700'); return; }
  // Ouvre la recherche dans une nouvelle fen√™tre
  window.open(`https://www.deezer.com/search/${query}`, '_blank', 'width=1000,height=700');
}
function searchYTMusic() {
  const query = encodeURIComponent(document.getElementById('search').value.trim());
  if (!query) { window.open(`https://music.youtube.com/`, '_blank', 'width=1000,height=700'); return; }
  // Ouvre la recherche dans une nouvelle fen√™tre
  window.open(`https://music.youtube.com/search?q=${query}`, '_blank', 'width=1000,height=700');
}

async function addMusic() {
  const link = document.getElementById('link').value.trim();
  if (!link.startsWith('http')) { msg.textContent = '‚ö†Ô∏è Entre un lien YouTube valide.'; return; }

  try {
    const res = await fetch(`/add?caf√©=${encodeURIComponent(cafe)}&link=${encodeURIComponent(link)}`);
    if (res.ok) {
      msg.textContent = '‚úÖ Ta musique a √©t√© ajout√©e au jukebox !';
      document.getElementById('link').value = '';
      document.getElementById('search').value = '';
    } else {
      msg.textContent = '‚ùå Erreur lors de l‚Äôajout.';
    }
  } catch (e) {
    msg.textContent = '‚ö†Ô∏è Erreur r√©seau.';
  }
}
</script>
</body>
</html>
