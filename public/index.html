<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>JukeBox Caf√© - Ajouter</title>
<style>
  body { font-family: system-ui, sans-serif; text-align:center; background:#faf6f0; padding:2em; }
  input { width:90%; max-width:400px; padding:0.8em; margin:1em 0; border:2px solid #d66b00; border-radius:10px; font-size:1em; }
  button { background:#d66b00; color:#fff; border:none; padding:0.8em 2em; border-radius:10px; font-size:1em; cursor:pointer; }
  button:hover { background:#ff7f00; }
  iframe { width:100%; height:600px; border:1px solid #d66b00; border-radius:10px; margin-top:1em; }
  #msg { margin-top:0.5em; color:#555; font-size:0.9em; }
</style>
</head>
<body>
  <h1>üéµ JukeBox Caf√©</h1>
  <p>Recherche ta musique directement dans l‚Äôiframe :</p>

  <!-- Champ pour coller le lien copi√© dans l'iframe -->
  <input id="link" type="url" placeholder="Colle le lien YouTube Music ici">
  <br>
  <button onclick="addMusic()">üé∂ Ajouter au jukebox</button>
  <p id="msg"></p>

  <!-- Iframe YouTube Music pour rechercher directement -->
  <iframe id="ytMusic" src="https://music.youtube.com" allowfullscreen></iframe>

<script>
  const params = new URLSearchParams(window.location.search);
  const cafe = params.get('caf√©') || 'default';
  const msg = document.getElementById('msg');

  async function addMusic() {
    const link = document.getElementById('link').value.trim();
    if (!link.startsWith('http')) { msg.textContent = '‚ö†Ô∏è Entre un lien YouTube valide.'; return; }

    try {
      const res = await fetch(`/add?caf√©=${encodeURIComponent(cafe)}&link=${encodeURIComponent(link)}`);
      if (res.ok) {
        msg.textContent = '‚úÖ Ta musique a √©t√© ajout√©e au jukebox !';
        document.getElementById('link').value = '';
      } else {
        msg.textContent = '‚ùå Erreur lors de l‚Äôajout.';
      }
    } catch(e) {
      msg.textContent = '‚ö†Ô∏è Erreur r√©seau.';
    }
  }
</script>
</body>
</html>
